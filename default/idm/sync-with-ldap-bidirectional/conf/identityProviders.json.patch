[
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.name === 'amazon';}).length) { content.push(amazon_provider); } content;",
                "globals" : {
                    "amazon_provider" : {
                        "name" : "amazon",
                        "type" : "OAUTH",
                        "icon" : "",
                        "scope" : [
                            "profile"
                        ],
                        "authenticationId" : "user_id",
                        "propertyMap" : [
                            {
                                "source" : "user_id",
                                "target" : "id"
                            },
                            {
                                "source" : "name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "email",
                                "target" : "email"
                            },
                            {
                                "source" : "email",
                                "target" : "username"
                            }
                        ],
                        "schema" : {
                            "id" : "http://jsonschema.net",
                            "title" : "Amazon",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "user_id" : {
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "name" : {
                                    "title" : "Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "email" : {
                                    "title" : "Email Address",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "user_id",
                                "name",
                                "email"
                            ],
                            "required" : [ ]
                        },
                        "enabled" : false,
                        "client_id" : "",
                        "client_secret" : "",
                        "authorization_endpoint" : "https://www.amazon.com/ap/oa",
                        "token_endpoint" : "https://api.amazon.com/auth/o2/token",
                        "userinfo_endpoint" : "https://api.amazon.com/user/profile"
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.name === 'wordpress';}).length) { content.push(wordpress_provider); } content;",
                "globals" : {
                    "wordpress_provider" : {
                        "name": "wordpress",
                        "type": "OAUTH",
                        "icon": "",
                        "scope": [
                            "auth"
                        ],
                        "authenticationId": "username",
                        "propertyMap": [
                            {
                                "source": "username",
                                "target": "username"
                            },
                            {
                                "source": "username",
                                "target": "id"
                            },
                            {
                                "source": "email",
                                "target": "email"
                            }
                        ],
                        "schema": {
                            "username": "http://jsonschema.net",
                            "title": "Wordpress",
                            "viewable": true,
                            "type": "object",
                            "$schema": "http://json-schema.org/draft-03/schema",
                            "properties": {
                                "username": {
                                    "title": "username",
                                    "viewable": true,
                                    "type": "string",
                                    "searchable": true
                                },
                                "email": {
                                    "title": "email",
                                    "viewable": true,
                                    "type": "string",
                                    "searchable": true
                                }
                            },
                            "order": [
                                "username",
                                "email"
                            ],
                            "required": []
                        },
                        "enabled": false,
                        "client_id": "",
                        "client_secret": "",
                        "authorization_endpoint": "https://public-api.wordpress.com/oauth2/authorize",
                        "token_endpoint": "https://public-api.wordpress.com/oauth2/token",
                        "userinfo_endpoint": "https://public-api.wordpress.com/rest/v1.1/me/"
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "var existing_yahoo = content.filter(function (m) {return m.name === 'yahoo';}); if (!existing_yahoo.length) { content.push(yahoo_provider); } else { existing_yahoo[0].icon = yahoo_provider.icon; } content;",
                "globals" : {
                    "yahoo_provider" : {
                        "name" : "yahoo",
                        "type" : "OPENID_CONNECT",
                        "icon": "",
                        "scope" : [
                            "openid",
                            "sdpp-w"
                        ],
                        "authenticationId" : "sub",
                        "propertyMap" : [
                            {
                                "source" : "sub",
                                "target" : "id"
                            },
                            {
                                "source" : "name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "given_name",
                                "target" : "givenName"
                            },
                            {
                                "source" : "family_name",
                                "target" : "familyName"
                            },
                            {
                                "source" : "email",
                                "target" : "email"
                            },
                            {
                                "source" : "email",
                                "target" : "username"
                            },
                            {
                                "source" : "locale",
                                "target" : "locale"
                            }
                        ],
                        "schema" : {
                            "id" : "http://jsonschema.net",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "sub" : {
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "name" : {
                                    "title" : "Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "given_name" : {
                                    "title" : "First Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "family_name" : {
                                    "title" : "Last Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "email" : {
                                    "title" : "Email Address",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "locale" : {
                                    "title" : "Locale Code",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "sub",
                                "name",
                                "given_name",
                                "family_name",
                                "email",
                                "locale"
                            ],
                            "required" : [ ]
                        },
                        "client_id" : "",
                        "client_secret" : "",
                        "authorization_endpoint" : "https://api.login.yahoo.com/oauth2/request_auth",
                        "token_endpoint" : "https://api.login.yahoo.com/oauth2/get_token",
                        "well-known" : "https://login.yahoo.com/.well-known/openid-configuration"
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source": "var updateConfig = function(p) { Object.keys(toRename).forEach(function(key) { if ( p[key] != null ) { p[toRename[key]] = p[key] }; delete p[key]; }); Object.keys(toAdd).forEach(function(key) {p[key] = toAdd[key];}); p.configClass = (p.type === 'OPENID_CONNECT' ? 'org.forgerock.oauth.clients.oidc.OpenIDConnectClientConfiguration' : 'org.forgerock.oauth.clients.oauth2.OAuth2ClientConfiguration'); toDelete.forEach(function(key) { delete p[key]; }); return p; }; openidm.query('config', {'_queryFilter': '_id sw \"identityProvider/\"'}).result.map(function(idp) { openidm.update('config/' + idp._id, null, updateConfig(idp)); }); content.map(updateConfig);",
                "globals" : {
                    "toRename" : {
                        "name" : "provider",
                        "authorization_endpoint" : "authorizationEndpoint",
                        "token_endpoint" : "tokenEndpoint",
                        "userinfo_endpoint" : "userInfoEndpoint",
                        "well-known" : "wellKnownEndpoint",
                        "client_id" : "clientId",
                        "client_secret" : "clientSecret",
                        "authenticationId" : "authenticationIdKey"
                    },
                    "toDelete": [
                        "type",
                        "icon"
                    ],
                    "toAdd": {
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "basicAuth" : false
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source": "openidm.query('config', {'_queryFilter': '_id sw \"identityProvider/\"'}).result.map(function(idp) { idp.uiConfig = uiConfigs[idp.provider] && uiConfigs[idp.provider]; openidm.update('config/' + idp._id, null,idp);}); content.map(function(idp){ idp.uiConfig = uiConfigs[idp.provider] && uiConfigs[idp.provider]; return idp; });",
                "globals" : {
                    "uiConfigs": {
                        "facebook": {
                            "iconBackground" : "#3b5998",
                            "iconClass" : "fa-facebook",
                            "iconFontColor" : "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-facebook-official",
                            "buttonDisplayName" : "Facebook",
                            "buttonCustomStyle" : "background-color: #3b5998;border-color: #3b5998; color: white;",
                            "buttonCustomStyleHover" : "background-color: #334b7d;border-color: #334b7d; color: white;"
                        },
                        "linkedIn": {
                            "iconBackground" : "#0077b5",
                            "iconClass" : "fa-linkedin",
                            "iconFontColor" : "white",
                            "buttonImage" : "",
                            "buttonClass" : "fa-linkedin",
                            "buttonDisplayName" : "LinkedIn",
                            "buttonCustomStyle" : "background-color:#0077b5;border-color:#0077b5;color:white;",
                            "buttonCustomStyleHover" : "background-color:#006ea9; border-color:#006ea9;color:white;"
                        },
                        "google": {
                            "iconBackground": "#4184f3",
                            "iconClass": "fa-google",
                            "iconFontColor": "white",
                            "buttonImage": "images/g-logo.png",
                            "buttonClass": "",
                            "buttonCustomStyle": "background-color: #fff; color: #757575; border-color: #ddd;",
                            "buttonCustomStyleHover": "color: #6d6d6d; background-color: #eee; border-color: #ccc;",
                            "buttonDisplayName": "Google"
                        },
                        "amazon": {
                            "iconBackground" : "#f0c14b",
                            "iconClass" : "fa-amazon",
                            "iconFontColor" : "black",
                            "buttonImage" : "",
                            "buttonClass": "fa-amazon",
                            "buttonDisplayName" : "Amazon",
                            "buttonCustomStyle" : "background: linear-gradient(to bottom, #f7e09f 15%,#f5c646 85%);color: black;border-color: #b48c24;",
                            "buttonCustomStyleHover" : "background: linear-gradient(to bottom, #f6c94e 15%,#f6c94e 85%);color: black;border-color: #b48c24;"
                        },
                        "wordpress": {
                            "iconBackground" : "#0095cc",
                            "iconClass" : "fa-wordpress",
                            "iconFontColor" : "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-wordpress",
                            "buttonDisplayName" : "WordPress",
                            "buttonCustomStyle" : "background-color: #0095cc; border-color: #0095cc; color:white;",
                            "buttonCustomStyleHover" : "background-color: #0095cc; border-color: #0095cc; color:white;"
                        },
                        "yahoo": {
                            "iconBackground": "#7B0099",
                            "iconClass": "fa-yahoo",
                            "iconFontColor": "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-yahoo",
                            "buttonDisplayName" : "Yahoo",
                            "buttonCustomStyle" : "background-color: #7B0099; border-color: #7B0099; color:white;",
                            "buttonCustomStyleHover" : "background-color: #7B0099; border-color: #7B0099; color:white;"
                        }
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'vkontakte';}).length) { content.push(vkontakte_provider); } content;",
                "globals" : {
                    "vkontakte_provider" : {
                        "provider" : "vkontakte",
                        "configClass" : "org.forgerock.oauth.clients.vk.VKClientConfiguration",
                        "basicAuth" : false,
                        "clientId" : "",
                        "clientSecret" : "",
                        "authorizationEndpoint" : "https://oauth.vk.com/authorize",
                        "tokenEndpoint" : "https://oauth.vk.com/access_token",
                        "userInfoEndpoint" : "https://api.vk.com/method/users.get",
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "scope" : [
                            "email"
                        ],
                        "uiConfig": {
                            "iconBackground": "#4c75a3",
                            "iconClass": "fa-vk",
                            "iconFontColor": "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-vk",
                            "buttonDisplayName" : "VK",
                            "buttonCustomStyle" : "background-color: #4c75a3; border-color: #4c75a3;color: white;",
                            "buttonCustomStyleHover" : "background-color: #43658c; border-color: #43658c;color: white;"
                        },
                        "authenticationIdKey" : "uid",
                        "propertyMap" : [
                            {
                                "source" : "uid",
                                "target" : "id"
                            },
                            {
                                "source" : "first_name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "first_name",
                                "target" : "givenName"
                            },
                            {
                                "source" : "last_name",
                                "target" : "familyName"
                            },
                            {
                                "source" : "email",
                                "target" : "email"
                            },
                            {
                                "source" : "email",
                                "target" : "username"
                            }
                        ],
                        "schema" : {
                            "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Vkontakte",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "uid" : {
                                    "description": "ID",
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "name" : {
                                    "description": "Name",
                                    "title" : "Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "first_name" : {
                                    "description": "First Name",
                                    "title" : "First Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "last_name" : {
                                    "description": "Last Name",
                                    "title" : "Last Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "email" : {
                                    "description" : "Email Address",
                                    "title" : "Email Address",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "uid",
                                "name",
                                "last_name",
                                "first_name",
                                "email"
                            ],
                            "required" : [ ]
                        }
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'instagram';}).length) { content.push(instagram_provider); } content;",
                "globals" : {
                    "instagram_provider" : {
                        "provider" : "instagram",
                        "configClass" : "org.forgerock.oauth.clients.instagram.InstagramClientConfiguration",
                        "basicAuth" : false,
                        "clientId" : "",
                        "clientSecret" : "",
                        "authorizationEndpoint" : "https://api.instagram.com/oauth/authorize/",
                        "tokenEndpoint" : "https://api.instagram.com/oauth/access_token",
                        "userInfoEndpoint" : "https://api.instagram.com/v1/users/self/",
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "scope" : [
                            "basic",
                            "public_content"
                        ],
                        "uiConfig": {
                            "iconBackground": "#3f729b",
                            "iconClass": "fa-instagram",
                            "iconFontColor": "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-instagram",
                            "buttonDisplayName" : "Instagram",
                            "buttonCustomStyle" : "background-color: #3f729b; border-color: #3f729b;color: white;",
                            "buttonCustomStyleHover" : "background-color: #305777; border-color: #305777;color: white;"
                        },
                        "connectionTimeout" : 0,
                        "readTimeout" : 0,
                        "authenticationIdKey" : "id",
                        "propertyMap" : [
                            {
                                "source" : "id",
                                "target" : "id"
                            },
                            {
                                "full_name" : "full_name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "profile_picture",
                                "target" : "photoUrl"
                            },
                            {
                                "source" : "username",
                                "target" : "username"
                            }
                        ],
                        "schema" : {
                            "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Instagram",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "id" : {
                                    "description": "ID",
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "full_name" : {
                                    "description": "Full Name",
                                    "title" : "Full Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "profile_picture" : {
                                    "description": "Profile Picture URL",
                                    "title" : "Profile Picture URL",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "username" : {
                                    "description": "Username",
                                    "title" : "Username",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }

                            },
                            "order" : [
                                "id",
                                "full_name",
                                "profile_picture",
                                "photoUrl",
                                "username"
                            ],
                            "required" : [ ]
                        }
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'wechat';}).length) { content.push(wechat_provider); } content;",
                "globals" : {
                    "wechat_provider" : {
                        "provider" : "wechat",
                        "configClass" : "org.forgerock.oauth.clients.wechat.WeChatClientConfiguration",
                        "basicAuth" : false,
                        "clientId" : "",
                        "clientSecret" : "",
                        "authorizationEndpoint" : "https://open.weixin.qq.com/connect/qrconnect",
                        "tokenEndpoint" : "https://api.wechat.com/sns/oauth2/access_token",
                        "refreshTokenEndpoint" : "https://api.wechat.com/sns/oauth2/refresh_token",
                        "userInfoEndpoint" : "https://api.wechat.com/sns/userinfo",
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "scope" : [
                            "snsapi_login"
                        ],
                        "uiConfig": {
                            "iconBackground": "#09b507",
                            "iconClass": "fa-wechat",
                            "iconFontColor": "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-wechat",
                            "buttonDisplayName" : "WeChat",
                            "buttonCustomStyle" : "background-color: #09b507; border-color: #09b507;color: white;",
                            "buttonCustomStyleHover" : "background-color: #09a007; border-color: #09a007;color: white;"
                        },
                        "connectionTimeout" : 0,
                        "readTimeout" : 0,
                        "authenticationIdKey" : "openid",
                        "propertyMap" : [
                            {
                                "source" : "openid",
                                "target" : "id"
                            },
                            {
                                "source" : "nickname",
                                "target" : "displayName"
                            },
                            {
                                "source" : "nickname",
                                "target" : "username"
                            },
                            {
                                "source" : "headimgurl",
                                "target" : "photoUrl"
                            }
                        ],
                        "schema" : {
                            "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Wechat",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "openid" : {
                                    "description": "ID",
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "nickname" : {
                                    "description": "Username",
                                    "title" : "Username",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "headimgurl" : {
                                    "description": "Profile Picture URL",
                                    "title" : "Profile Picture URL",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "openid",
                                "nickname",
                                "headimgurl"
                            ],
                            "required" : [ ]
                        }
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'microsoft';}).length) { content.push(microsoft_provider); } content;",
                "globals" : {
                    "microsoft_provider" : {
                          "provider" : "microsoft",
                          "authorizationEndpoint" : "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
                          "tokenEndpoint" : "https://login.microsoftonline.com/common/oauth2/v2.0/token",
                          "userInfoEndpoint" : "https://graph.microsoft.com/v1.0/me",
                          "clientId" : "",
                          "clientSecret" : "",
                          "scope" : [
                              "User.Read"
                          ],
                          "uiConfig": {
                              "iconBackground": "#0078d7",
                              "iconClass": "fa-windows",
                              "iconFontColor": "white",
                              "buttonImage" : "images/microsoft-logo.png",
                              "buttonClass": "",
                              "buttonDisplayName" : "Microsoft",
                              "buttonCustomStyle" : "background-color: #fff; border-color: #8b8b8b; color: #8b8b8b;",
                              "buttonCustomStyleHover" : "background-color: #fff; border-color: #8b8b8b; color: #8b8b8b;"
                          },
                          "authenticationIdKey" : "id",
                          "basicAuth" : false,
                          "schema" : {
                              "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Microsoft",
                              "title": "Microsoft",
                              "viewable" : true,
                              "type" : "object",
                              "$schema" : "http://json-schema.org/draft-03/schema",
                              "properties" : {
                                  "id" : {
                                      "description": "ID",
                                      "title" : "ID",
                                      "viewable" : true,
                                      "type" : "string",
                                      "searchable" : false
                                  },
                                  "displayName" : {
                                      "description": "Name",
                                      "title" : "Name",
                                      "viewable" : true,
                                      "type" : "string",
                                      "searchable" : true
                                  },
                                  "givenName" : {
                                      "description": "First Name",
                                      "title" : "First Name",
                                      "viewable" : true,
                                      "type" : "string",
                                      "searchable" : true
                                  },
                                  "surname" : {
                                      "description": "Last Name",
                                      "title" : "Last Name",
                                      "viewable" : true,
                                      "type" : "string",
                                      "searchable" : true
                                  },
                                  "userPrincipalName": {
                                      "description": "Email Address",
                                      "title": "Email Address",
                                      "viewable": true,
                                      "type": "string",
                                      "searchable": true
                                  }
                              },
                              "order" : [
                                  "id",
                                  "displayName",
                                  "userPrincipalName",
                                  "givenName",
                                  "surname"
                              ],
                              "required" : [ ]
                          },
                        "propertyMap": [
                            {
                                "source" : "id",
                                "target" : "id"
                            },
                            {
                                "source" : "displayName",
                                "target" : "displayName"
                            },
                            {
                                "source" : "givenName",
                                "target" : "givenName"
                            },
                            {
                                "source" : "surname",
                                "target" : "familyName"
                            },
                            {
                                "source" : "userPrincipalName",
                                "target" : "email"
                            },
                            {
                                "source" : "userPrincipalName",
                                "target" : "username"
                            }
                        ],
                          "redirectUri" : "https://localhost:8443/oauthReturn/",
                          "configClass" : "org.forgerock.oauth.clients.oauth2.OAuth2ClientConfiguration"
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'salesforce';}).length) { content.push(salesforce_provider); } content;",
                "globals" : {
                    "salesforce_provider" : {
                        "provider" : "salesforce",
                        "authorizationEndpoint" : "https://login.salesforce.com/services/oauth2/authorize",
                        "tokenEndpoint" : "https://login.salesforce.com/services/oauth2/token",
                        "userInfoEndpoint" : "https://login.salesforce.com/services/oauth2/userinfo",
                        "clientId" : "",
                        "clientSecret" : "",
                        "scope" : [
                            "id",
                            "api",
                            "web"
                        ],
                        "uiConfig": {
                            "iconBackground": "#21a0df",
                            "iconClass": "fa-cloud",
                            "iconFontColor": "white",
                            "buttonImage" : "",
                            "buttonClass": "fa-cloud",
                            "buttonDisplayName" : "Salesforce",
                            "buttonCustomStyle" : "background-color: #21a0df; border-color: #21a0df; color: white;",
                            "buttonCustomStyleHover" : "background-color: #21a0df; border-color: #21a0df; color: white;"
                        },
                        "authenticationIdKey" : "user_id",
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "configClass" : "org.forgerock.oauth.clients.oauth2.OAuth2ClientConfiguration",
                        "basicAuth": false,
                        "schema" : {
                            "id" : "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Salesforce",
                            "title" : "Salesforce",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "user_id" : {
                                    "description": "ID",
                                    "title" : "ID",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "name" : {
                                    "description": "Name",
                                    "title" : "Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "given_name" : {
                                    "description": "First Name",
                                    "title" : "First Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "family_name" : {
                                    "description": "Last Name",
                                    "title" : "Last Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "email" : {
                                    "description": "Email Address",
                                    "title" : "Email Address",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "zoneInfo" : {
                                    "description": "Locale Code",
                                    "title" : "Locale Code",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "user_id",
                                "name",
                                "given_name",
                                "family_name",
                                "email",
                                "zoneInfo"
                            ],
                            "required" : [ ]
                        },
                        "propertyMap" : [
                            {
                                "source" : "user_id",
                                "target" : "id"
                            },
                            {
                                "source" : "name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "given_name",
                                "target" : "givenName"
                            },
                            {
                                "source" : "family_name",
                                "target" : "familyName"
                            },
                            {
                                "source" : "email",
                                "target" : "email"
                            },
                            {
                                "source" : "email",
                                "target" : "username"
                            },
                            {
                                "source" : "zoneInfo",
                                "target" : "locale"
                            }
                        ]
                    }
                }
            }
        }
    },
    {
        "operation" : "transform",
        "field" : "/providers",
        "value" : {
            "script" : {
                "type" : "text/javascript",
                "source" : "if (!content.filter(function (m) {return m.provider === 'twitter';}).length) { content.push(twitter_provider); } content;",
                "globals" : {
                    "twitter_provider" : {
                        "provider" : "twitter",
                        "requestTokenEndpoint" : "https://api.twitter.com/oauth/request_token",
                        "authorizationEndpoint" : "https://api.twitter.com/oauth/authenticate",
                        "tokenEndpoint" : "https://api.twitter.com/oauth/access_token",
                        "userInfoEndpoint" : "https://api.twitter.com/1.1/account/verify_credentials.json",
                        "clientId" : "",
                        "clientSecret" : "",
                        "uiConfig" : {
                            "iconBackground" : "#00b6e9",
                            "iconClass" : "fa-twitter",
                            "iconFontColor" : "white",
                            "buttonImage" : "",
                            "buttonClass" : "fa-twitter",
                            "buttonDisplayName" : "Twitter",
                            "buttonCustomStyle" : "background-color: #00b6e9; border-color: #00b6e9; color: #fff;",
                            "buttonCustomStyleHover" : "background-color: #01abda; border-color: #01abda; color: #fff;"
                         },
                        "authenticationIdKey" : "id_str",
                        "redirectUri" : "https://localhost:8443/oauthReturn/",
                        "configClass" : "org.forgerock.oauth.clients.twitter.TwitterClientConfiguration",
                        "schema" : {
                            "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Twitter",
                            "title" : "Twitter",
                            "viewable" : true,
                            "type" : "object",
                            "$schema" : "http://json-schema.org/draft-03/schema",
                            "properties" : {
                                "id_str" : {
                                    "description": "ID",
                                    "title" : "Id",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "name" : {
                                    "description": "Full Name",
                                    "title" : "Full Name",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "screen_name" : {
                                    "description": "User Id",
                                    "title" : "User Id",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                },
                                "email" : {
                                    "description": "Email Address",
                                    "title" : "Email Address",
                                    "viewable" : true,
                                    "type" : "string",
                                    "searchable" : true
                                }
                            },
                            "order" : [
                                "id_str",
                                "name",
                                "screen_name",
                                "email"
                            ],
                            "required" : [ ]
                        },
                        "propertyMap" : [
                            {
                                "source" : "id_str",
                                "target" : "id"
                            },
                            {
                                "source" : "name",
                                "target" : "displayName"
                            },
                            {
                                "source" : "email",
                                "target" : "email"
                            },
                            {
                                "source" : "screen_name",
                                "target" : "username"
                            }
                        ]
                    }
                }
            }
        }
    },
    {
        "operation": "transform",
        "field": "/providers",
        "value": {
            "script": {
                "type": "text/javascript",
                "source": "var _ = require('lib/lodash'), toJSObject = function (obj) {return JSON.parse((new com.fasterxml.jackson.databind.ObjectMapper()).writeValueAsString(obj)) }, updateConfig = function(p) { return toUpdate[p.provider] ? _.merge(toJSObject(p), toJSObject(toUpdate[p.provider])) : p; }; openidm.query('config', { '_queryFilter': '_id sw \"identityProvider/\"' }).result.map(function(idp) { openidm.update('config/' + idp._id, null, updateConfig(idp)); }); content.map(updateConfig);",
                "globals": {
                    "toUpdate": {
                        "google": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Google",
                                "properties": {
                                    "sub": {
                                        "description": "ID"
                                    },
                                    "name": {
                                        "description": "Name"
                                    },
                                    "given_name": {
                                        "description": "First Name"
                                    },
                                    "family_name": {
                                        "description": "Last Name"
                                    },
                                    "picture": {
                                        "description": "Profile Picture URL"
                                    },
                                    "email": {
                                        "description": "Email Address"
                                    },
                                    "locale": {
                                        "description": "Locale Code"
                                    }
                                }
                            }
                        },
                        "facebook": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Facebook",
                                "properties": {
                                    "id": {
                                        "description": "ID"
                                    },
                                    "name": {
                                        "description": "Name"
                                    },
                                    "first_name": {
                                        "description": "First Name"
                                    },
                                    "last_name": {
                                        "description": "Last Name"
                                    },
                                    "email": {
                                        "description": "Email Address"
                                    },
                                    "locale": {
                                        "description": "Locale Code"
                                    }
                                }
                            }
                        },
                        "linkedIn": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:LinkedIn",
                                "properties": {
                                    "id": {
                                        "description": "ID"
                                    },
                                    "formattedName": {
                                        "description": "Formatted Name"
                                    },
                                    "firstName": {
                                        "description": "First Name"
                                    },
                                    "lastName": {
                                        "description": "Last Name"
                                    },
                                    "emailAddress": {
                                        "description": "Email Address"
                                    },
                                    "location": {
                                        "description": "Location",
                                        "properties": {
                                            "country": {
                                                "description": "Country",
                                                "properties": {
                                                    "code": {
                                                        "description": "Locale Code"
                                                    }
                                                }
                                            },
                                            "name": {
                                                "description": "Area Name"
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "amazon": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Amazon",
                                "properties": {
                                    "user_id": {
                                        "description": "ID"
                                    },
                                    "name": {
                                        "description": "Name"
                                    },
                                    "email": {
                                        "description": "Email Address"
                                    }
                                }
                            }
                        },
                        "wordpress": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Wordpress",
                                "properties": {
                                    "username": {
                                        "description": "username"
                                    },
                                    "email": {
                                        "description": "email"
                                    }
                                }
                            }
                        },
                        "yahoo": {
                            "schema": {
                                "id": "urn:jsonschema:org:forgerock:openidm:identityProviders:api:Yahoo",
                                "properties": {
                                    "sub": {
                                        "description": "ID"
                                    },
                                    "name": {
                                        "description": "Name"
                                    },
                                    "given_name": {
                                        "description": "First Name"
                                    },
                                    "family_name": {
                                        "description": "Last Name"
                                    },
                                    "email": {
                                        "description": "Email Address"
                                    },
                                    "locale": {
                                        "description": "Locale Code"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
]